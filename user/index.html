



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for the Atomist Development Automation Platform">
      
      
      
        <meta name="author" content="The Atomist Team">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.1, mkdocs-material-2.0.4">
    
    
      
        <title>Using Atomist - The Atomist Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application-709eec9410.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-23f75ab9c7.palette.css">
      
    
    
      <script src="../assets/javascripts/modernizr-e826f8942a.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
  </head>
  
    
    
    
      <body data-md-color-primary="blue-grey" data-md-color-accent="blue">
    
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="The Atomist Documentation" class="md-header-nav__button md-logo">
          
            <img src="../img/atomist-logo-horiz-reversed.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
            
            Using Atomist
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../img/atomist-logo-horiz-reversed.svg" width="24" height="24">
      
    </span>
    The Atomist Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Using Atomist
      </label>
    
    <a href="./" title="Using Atomist" class="md-nav__link md-nav__link--active">
      Using Atomist
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#slack" title="Slack" class="md-nav__link">
    Slack
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enroll-slack-bot" title="Enroll Slack bot" class="md-nav__link">
    Enroll Slack bot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slack-team-id" title="Slack team ID" class="md-nav__link">
    Slack team ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-atomist-from-slack" title="Removing Atomist from Slack" class="md-nav__link">
    Removing Atomist from Slack
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github" title="GitHub" class="md-nav__link">
    GitHub
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#github-user-authorization" title="GitHub user authorization" class="md-nav__link">
    GitHub user authorization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#organization-webhooks" title="Organization webhooks" class="md-nav__link">
    Organization webhooks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repository-webhooks" title="Repository webhooks" class="md-nav__link">
    Repository webhooks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linking-slack-github" title="Linking Slack &amp; GitHub" class="md-nav__link">
    Linking Slack &amp; GitHub
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#continuous-integration" title="Continuous integration" class="md-nav__link">
    Continuous integration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#circleci" title="CircleCI" class="md-nav__link">
    CircleCI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jenkins" title="Jenkins" class="md-nav__link">
    Jenkins
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#travis-ci" title="Travis CI" class="md-nav__link">
    Travis CI
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../quick-start/" title="Developer Quick Start" class="md-nav__link">
      Developer Quick Start
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Developer Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Developer Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../developer/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../developer/prerequisites/" title="Prerequisites" class="md-nav__link">
      Prerequisites
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../developer/commands/" title="Commands" class="md-nav__link">
      Commands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../developer/events/" title="Events" class="md-nav__link">
      Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../developer/slack/" title="Slack Messages" class="md-nav__link">
      Slack Messages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../developer/graphql/" title="Working with GraphQL" class="md-nav__link">
      Working with GraphQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../developer/create/" title="Creating Projects" class="md-nav__link">
      Creating Projects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../developer/editors/" title="Editing Projects" class="md-nav__link">
      Editing Projects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../developer/client/" title="Automation Client" class="md-nav__link">
      Automation Client
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../developer/run/" title="Running Automation Clients" class="md-nav__link">
      Running Automation Clients
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../support/" title="Support" class="md-nav__link">
      Support
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#slack" title="Slack" class="md-nav__link">
    Slack
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enroll-slack-bot" title="Enroll Slack bot" class="md-nav__link">
    Enroll Slack bot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slack-team-id" title="Slack team ID" class="md-nav__link">
    Slack team ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-atomist-from-slack" title="Removing Atomist from Slack" class="md-nav__link">
    Removing Atomist from Slack
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github" title="GitHub" class="md-nav__link">
    GitHub
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#github-user-authorization" title="GitHub user authorization" class="md-nav__link">
    GitHub user authorization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#organization-webhooks" title="Organization webhooks" class="md-nav__link">
    Organization webhooks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repository-webhooks" title="Repository webhooks" class="md-nav__link">
    Repository webhooks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linking-slack-github" title="Linking Slack &amp; GitHub" class="md-nav__link">
    Linking Slack &amp; GitHub
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#continuous-integration" title="Continuous integration" class="md-nav__link">
    Continuous integration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#circleci" title="CircleCI" class="md-nav__link">
    CircleCI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jenkins" title="Jenkins" class="md-nav__link">
    Jenkins
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#travis-ci" title="Travis CI" class="md-nav__link">
    Travis CI
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Using Atomist</h1>
                
                <script>
    /**
    * Function that tracks a click on an outbound link in Analytics.
    * This function takes a valid URL string as an argument, and uses that URL string
    * as the event label. Setting the transport method to 'beacon' lets the hit be sent
    * using 'navigator.sendBeacon' in browser that support it.
    */
    var trackOutboundLink = function(url) {
        ga('send', 'event', 'outbound', 'click', url, {
            'transport': 'beacon',
            'hitCallback': function(){document.location = url;}
        });
    }
</script>

<p>This is a step by step guide to setting up Atomist&rsquo;s built-in
automations to see and control your development flow
from <a href="https://slack.com/" title="Slack">Slack</a>.  To write your own automations, see the
full <a href="../developer/" title="Atomist Developer Guide">developer guide</a>.</p>
<h2 id="slack">Slack<a class="headerlink" href="#slack" title="Permanent link">&para;</a></h2>
<h3 id="enroll-slack-bot">Enroll Slack bot<a class="headerlink" href="#enroll-slack-bot" title="Permanent link">&para;</a></h3>
<p>Click the &ldquo;Add to Slack&rdquo; button below to invite the Atomist bot into
your Slack team.</p>
<div style="text-align:center;">
  <a href="https://atm.st/2wiDlUe" onclick="trackOutboundLink('https://atm.st/2wiDlUe'); return false;" target="_blank">
    <img alt="Add to Slack" height="50" width="174" src="https://platform.slack-edge.com/img/add_to_slack.png" srcset="https://platform.slack-edge.com/img/add_to_slack.png 1x, https://platform.slack-edge.com/img/add_to_slack@2x.png 2x" />
  </a>
</div>

<p>Slack&rsquo;s default configuration allows all team members to add new Slack applications.
However, your team&rsquo;s admins may decide to restrict the set of applications that can
can be added in your team.  The <a href="https://slack.com/apps/manage/permissions">permissions management page</a> has
an &ldquo;Approved Apps&rdquo; setting to control this.</p>
<p><img alt="Slack Approved Apps" src="./img/ApprovedApps.png" /></p>
<p>If your team requires approval for new apps and you&rsquo;re not a Slack
administrator, Slack helps you request approval from your Slack team&rsquo;s
administrators to install the Atomist application.</p>
<p>Currently the authorization process asks you to authorize two things:</p>
<ol>
<li>The Atomist app adds a bot user named &ldquo;@atomist&rdquo; to your team.
    Your team can <code>\invite</code> the Atomist bot to channels to access the
    full functionality of Atomist.  Bot users cannot create channels,
    cannot join channels unless they are invited by a non-bot channel
    member, and cannot see messages in channels where they are not a
    member.</li>
<li>Atomist requests a scope called &ldquo;Modify public channels&rdquo;.  This
    scope allows Atomist to help you setup channels.  For example,
    when you <a href="../developer/create/" title="Create Project with Atomist">create a project</a> in a new GitHub
    repository, Atomist can create a Slack channel to go with it.</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Atomist app creates new channels on behalf of the user who
first authorizes Atomist.</p>
</div>
<h3 id="slack-team-id">Slack team ID<a class="headerlink" href="#slack-team-id" title="Permanent link">&para;</a></h3>
<p>Some operations, like <a href="#continuous-integration" title="Connecting Atomist with Continuous Integration Platforms">connecting your CI with Atomist</a>, need you to pass
in your Slack team ID. To get your Slack team ID, send <code>team</code> to the Atomist
bot.</p>
<div class="codehilite"><pre><span></span>you&gt; /invite @atomist
you&gt; @atomist team
atomist&gt; The Slack id for team your-slack-team is T1L0V3JTP
         16 of 24 users in this team have authorized themselves
</pre></div>

<h3 id="removing-atomist-from-slack">Removing Atomist from Slack<a class="headerlink" href="#removing-atomist-from-slack" title="Permanent link">&para;</a></h3>
<p>You can remove the bot from all your channels instantly
by revoking access to the &ldquo;Atomist&rdquo; application.  We certainly hope it
doesn&rsquo;t come to this!</p>
<p>The <a href="https://slack.com/apps/A0HM83NCC-atomist?page=1">App Manage page</a> has a &ldquo;Remove App&rdquo; button at
the bottom of the page.  Please <a href="mailto:support@atomist.com">let us know</a> if
there&rsquo;s anything we can do to clarify how the bot works within your
Slack team.</p>
<h2 id="github">GitHub<a class="headerlink" href="#github" title="Permanent link">&para;</a></h2>
<p>Atomist helps you work with GitHub in two ways:</p>
<ol>
<li>By enabling webhooks, your automations can react to
    GitHub activities such as pushes, pull requests, or issues.</li>
<li>Automations can expose commands that access GitHub through
    the v3 api, authorized by OAuth tokens.
    Each user on your team must independently authorize Atomist &ndash;
    this means that your users remain within the boundaries
    of the existing GitHub security model.  Atomist acts on <em>behalf</em> of
    your users, not <em>instead</em> of them.</li>
</ol>
<h3 id="github-user-authorization">GitHub user authorization<a class="headerlink" href="#github-user-authorization" title="Permanent link">&para;</a></h3>
<p>When the Atomist bot first arrives in a team, it will send a direct
message to the authorizing user, requesting that they authorize
Atomist to access GitHub on their behalf.</p>
<p><img alt="GitHub Authorization" src="./img/github-auth.png" /></p>
<p>This same dialog will be shown to users anytime Atomist detects that
an automation needs to access GitHub as that user.  Every user on the
team must individually opt in.  Atomist will display this option each
time an un-authorized user runs a command that requires a GitHub
authorization.  Users can ask for their current GitHub authorization
status by running:</p>
<div class="codehilite"><pre><span></span>you&gt; @atomist github
</pre></div>

<p>Atomist will send a direct message to this user with their current
GitHub authorization status.</p>
<h3 id="organization-webhooks">Organization webhooks<a class="headerlink" href="#organization-webhooks" title="Permanent link">&para;</a></h3>
<p>GitHub organization members that have the <a href="https://help.github.com/articles/permission-levels-for-an-organization/">owner role</a>, are
allowed to configure organization webhooks.  This is convenient
because it only has to be configured once; however, you will require a
user who has the <code>Owner</code> role in your GitHub organization.</p>
<div class="codehilite"><pre><span></span>you&gt; @atomist enroll org
</pre></div>

<p>When you choose to enroll a GitHub organization, you will most likely
be prompted to authorize a new scope (Atomist only asks for new scopes
when explicitly required).  The <em>admin:org_hook</em> is required when
enrolling a new GitHub organization.</p>
<p><img alt="GitHub Authorize Organization Webhook" src="./img/authorize-org-hook.png" /></p>
<p>If you are a member of more than one GitHub organization, Atomist will
ask you to choose which organization to enroll.</p>
<p><img alt="Choose GitHub Organization" src="./img/choose-org.png" /></p>
<p>Finally, you will be presented with a button to configure the organization webhook.</p>
<p><img alt="Install GitHub Webhook" src="./img/install-webhook.png" /></p>
<h3 id="repository-webhooks">Repository webhooks<a class="headerlink" href="#repository-webhooks" title="Permanent link">&para;</a></h3>
<p>If your team does not use a GitHub organization account, you can
choose to configure webhooks on individual repositories owned by your
user account.</p>
<div class="codehilite"><pre><span></span>you&gt; @atomist install webhook
</pre></div>

<p>The bot now asks for the <code>owner</code> of the repository.  This question is
skipped if there is only one valid choice (your user account).  Next the bot
asks you to select the repository to receive the new webhook.</p>
<div style="text-align:center;">
  <img alt="Choose GitHub Repository" height="137" width="528" src="img/choose-repo.png" />
</div>

<h2 id="linking-slack-github">Linking Slack &amp; GitHub<a class="headerlink" href="#linking-slack-github" title="Permanent link">&para;</a></h2>
<p>Now that you have Slack and GitHub connected with Atomist, you should
&ldquo;link&rdquo; GitHub repositories with Slack channels so you can see and
control your project&rsquo;s activity from Slack.  All you need to do is
invite the Atomist bot to a Slack channel and then send it <code>repo</code>.</p>
<div class="codehilite"><pre><span></span>/invite @atomist
@atomist repo
</pre></div>

<p>The bot will open a thread and ask you what GitHub repository you want
to link to the channel.  If you added an organization webhook, you can
link any repository in your GitHub organization.  If you added
webhooks to individual repositories, you will only be able to link
those repositories.</p>
<h2 id="continuous-integration">Continuous integration<a class="headerlink" href="#continuous-integration" title="Permanent link">&para;</a></h2>
<p>Atomist natively supports several continuous integration
(CI) platforms, listening for CI events, correlating them with the
commits that triggered the build, and showing contextualized
notifications in a Slack channel linked to the repository.  To enable
this capability, just add the desired Atomist CI
webhook URL to your CI configuration.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the examples below, replace <code>TEAM_ID</code> with your Slack team ID.</p>
</div>
<h3 id="circleci">CircleCI<a class="headerlink" href="#circleci" title="Permanent link">&para;</a></h3>
<p>To send events from <a href="https://circleci.com/" title="CircleCI">CircleCI</a> to Atomist, add the following
snippet to your <code>.circleci/config.yml</code> configuration file.</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">notify</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">webhooks</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">https://webhook.atomist.com/atomist/circle/teams/TEAM_ID</span>
</pre></div>

<h3 id="jenkins">Jenkins<a class="headerlink" href="#jenkins" title="Permanent link">&para;</a></h3>
<p>You can send events from <a href="https://jenkins.io/" title="Jenkins">Jenkins</a> to Atomist using
the <a href="https://wiki.jenkins-ci.org/display/JENKINS/Notification+Plugin" title="Jenkins Notification Plugin">notification plugin</a>, configuring it to send its
payload to
<code>https://webhook.atomist.com/atomist/jenkins/teams/TEAM_ID</code>.</p>
<p>If you configure your build using a <a href="https://jenkins.io/doc/book/pipeline/jenkinsfile/" title="Jenkinsfile"><code>Jenkinsfile</code></a>, add
these functions to your <code>Jenkinsfile</code>.  Don&rsquo;t forget to replace
<code>TEAM_ID</code> with your Slack team ID.</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">groovy.json.JsonOutput</span>

<span class="kt">def</span> <span class="nf">getSCMInformation</span><span class="o">()</span> <span class="o">{</span>
    <span class="kt">def</span> <span class="n">gitUrl</span> <span class="o">=</span> <span class="n">sh</span><span class="o">(</span><span class="nl">returnStdout:</span> <span class="kc">true</span><span class="o">,</span> <span class="nl">script:</span> <span class="s1">&#39;git config --get remote.origin.url&#39;</span><span class="o">).</span><span class="na">trim</span><span class="o">()</span>
    <span class="kt">def</span> <span class="n">gitSha</span> <span class="o">=</span> <span class="n">sh</span><span class="o">(</span><span class="nl">returnStdout:</span> <span class="kc">true</span><span class="o">,</span> <span class="nl">script:</span> <span class="s1">&#39;git rev-parse HEAD&#39;</span><span class="o">).</span><span class="na">trim</span><span class="o">()</span>
    <span class="kt">def</span> <span class="n">gitBranch</span> <span class="o">=</span> <span class="n">sh</span><span class="o">(</span><span class="nl">returnStdout:</span> <span class="kc">true</span><span class="o">,</span> <span class="nl">script:</span> <span class="s1">&#39;git name-rev --always --name-only HEAD&#39;</span><span class="o">).</span><span class="na">trim</span><span class="o">().</span><span class="na">replace</span><span class="o">(</span><span class="s1">&#39;remotes/origin/&#39;</span><span class="o">,</span> <span class="s1">&#39;&#39;</span><span class="o">)</span>
    <span class="k">return</span> <span class="o">[</span> <span class="nl">url:</span> <span class="n">gitUrl</span><span class="o">,</span> <span class="nl">branch:</span> <span class="n">gitBranch</span><span class="o">,</span> <span class="nl">commit:</span> <span class="n">gitSha</span> <span class="o">]</span>
<span class="o">}</span>

<span class="kt">def</span> <span class="nf">notifyAtomist</span><span class="o">(</span><span class="n">buildStatus</span><span class="o">,</span> <span class="n">buildPhase</span><span class="o">=</span><span class="s2">&quot;FINALIZED&quot;</span><span class="o">,</span>
                  <span class="n">endpoint</span><span class="o">=</span><span class="s2">&quot;https://webhook.atomist.com/atomist/jenkins/teams/TEAM_ID&quot;</span><span class="o">)</span> <span class="o">{</span>

    <span class="kt">def</span> <span class="n">payload</span> <span class="o">=</span> <span class="n">JsonOutput</span><span class="o">.</span><span class="na">toJson</span><span class="o">([</span>
        <span class="nl">name:</span> <span class="n">env</span><span class="o">.</span><span class="na">JOB_NAME</span><span class="o">,</span>
        <span class="nl">duration:</span> <span class="n">currentBuild</span><span class="o">.</span><span class="na">duration</span><span class="o">,</span>
        <span class="nl">build:</span> <span class="o">[</span>
            <span class="nl">number:</span> <span class="n">env</span><span class="o">.</span><span class="na">BUILD_NUMBER</span><span class="o">,</span>
            <span class="nl">phase:</span> <span class="n">buildPhase</span><span class="o">,</span>
            <span class="nl">status:</span> <span class="n">buildStatus</span><span class="o">,</span>
            <span class="nl">full_url:</span> <span class="n">env</span><span class="o">.</span><span class="na">BUILD_URL</span><span class="o">,</span>
            <span class="nl">scm:</span> <span class="n">getSCMInformation</span><span class="o">()</span>
        <span class="o">]</span>
    <span class="o">])</span>
    <span class="n">sh</span> <span class="s2">&quot;curl --silent -XPOST -H &#39;Content-Type: application/json&#39; -d &#39;${payload}&#39; ${endpoint}&quot;</span>
<span class="o">}</span>
</pre></div>

<p>Then call <code>notifyAtomist</code> when the build starts (in the first
stage) and ends (in the <code>post</code> block), sending the appropriate
status and phase.</p>
<ul>
<li>Start: <code>notifyAtomist(&quot;STARTED&quot;, &quot;STARTED&quot;)</code></li>
<li>Succesful: <code>notifyAtomist(&quot;SUCCESS&quot;)</code></li>
<li>Unstable: <code>notifyAtomist(&quot;UNSTABLE&quot;)</code></li>
<li>Failure: <code>notifyAtomist(&quot;FAILURE&quot;)</code></li>
</ul>
<h3 id="travis-ci">Travis CI<a class="headerlink" href="#travis-ci" title="Permanent link">&para;</a></h3>
<p>To send events from <a href="https://travis-ci.org" title="Travis CI">Travis CI</a> to Atomist, add the
following snippet to your <code>.travis.yml</code> configuration file.</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">notifications</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">webhooks</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">urls</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">https://webhook.atomist.com/atomist/travis/teams/TEAM_ID</span>
    <span class="l l-Scalar l-Scalar-Plain">on_success</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>
    <span class="l l-Scalar l-Scalar-Plain">on_failure</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>
    <span class="l l-Scalar l-Scalar-Plain">on_start</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>
    <span class="l l-Scalar l-Scalar-Plain">on_cancel</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>
    <span class="l l-Scalar l-Scalar-Plain">on_error</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>
</pre></div>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Introduction" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Introduction
              </span>
            </div>
          </a>
        
        
          <a href="../quick-start/" title="Developer Quick Start" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Developer Quick Start
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; 2017 Atomist, Inc.
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://the-composition.com/" class="md-footer-social__link fa fa-medium"></a>
    
      <a href="https://github.com/atomist" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/atomist" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://join.atomist.com/" class="md-footer-social__link fa fa-slack"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application-8e4952e681.js"></script>
      
      <script>app.initialize({version:"0.17.1",url:{base:".."}})</script>
      
        <script src="../js/intercom.js"></script>
      
        <script src="../js/mixpanel.js"></script>
      
    
    
      
      <script>!function(e,t,a,n,o,c,i){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=t.createElement(a),i=t.getElementsByTagName(a)[0],c.async=1,c.src=n,i.parentNode.insertBefore(c,i)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-74966852-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var t=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",t,e.href)})});var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})</script>
      
    
  </body>
</html>